(self.webpackChunkFB_App=self.webpackChunkFB_App||[]).push([[5935],{5935:(t,r,e)=>{"use strict";e.r(r),e.d(r,{PagoPageModule:()=>b});var i=e(6274),a=e(4988),s=e(8620),n=e(8895),o=(()=>(function(t){t.creditCard="CreditCard",t.paypal="Paypal",t.bitcoin="Bitcoin",t.otium="Otium"}(o||(o={})),o))(),d=(()=>(function(t){t.received="Received",t.inPreparation="In preparation",t.prepared="Prepared",t.served="Served"}(d||(d={})),d))();class c{constructor(t,r,e,i,a,s,n,o,c,u,l){this.idOrder=t,this.idTable=r,this.idRestaurant=e,this.nameRestaurant=i,this.imgRestaurant=a,this.idUser=s,this.path=n,this.orderLines=o,this.totalPrice=c,this.dateOrder=new Date,this.state=d.received,this.paymentMethod=u,this.estimatedPreparationTime="Pending review",this.tip=l}}var u=e(7272),l=e(1855),h=e(2604);let p=(()=>{class t{constructor(t){this.storage=t,this._storage=null,this._otiumOrders=[],this.init()}get getOtiumOrders(){return[...this._otiumOrders]}init(){return(0,l.mG)(this,void 0,void 0,function*(){const t=yield this.storage.create();this._storage=t,this.loadOrders()})}saveOrder(t,r){return(0,l.mG)(this,void 0,void 0,function*(){this._otiumOrders=[r,...this._otiumOrders],this._storage.set(t,this._otiumOrders)})}loadOrders(){return(0,l.mG)(this,void 0,void 0,function*(){try{const t=yield this._storage.get("otium_orders");this._otiumOrders=t||[]}catch(t){}})}}return t.\u0275fac=function(r){return new(r||t)(u.LFG(h.K))},t.\u0275prov=u.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var m=e(5136),g=e(2149),O=e(3883);const Z=[{path:"",component:(()=>{class t{constructor(t,r,e,i){this.router=t,this.storageOrdersService=r,this.dataService=e,this.databaseService=i,this.otiumOrder="otium-order",this.otiumOrders="otium_orders",this.arrOrderLine=[],this.restaurantFromOrdersUsers={array:[]},this.initialbalance=0,this.finalbalance=this.initialbalance,this.percentToGet=10,this.inputTip=0,this.tip=0}ngOnInit(){this.loadOrderFromLocalStorage(),this.showTotalPriceInCart(),this.dataService.currentRestaurantData.subscribe(t=>this.restaurantData=t),this.databaseService.observableUser.subscribe(t=>this.dataUser=t),this.dataService.currentQrData.subscribe(t=>this.qrData=t),this.dataService.currentArrRestaurantsFromOrdersUsers.subscribe(t=>this.restaurantFromOrdersUsers=t)}sumTip(){console.log("inputTip ",this.inputTip),this.finalbalance=Number((this.initialbalance+this.inputTip).toFixed(2)),this.tip=this.inputTip}percentage(){this.inputTip=Number((this.percentToGet/100*this.initialbalance).toFixed(2))}loadOrderFromLocalStorage(){this.otiumOrderIsEmpty()||(this.arrOrderLine=JSON.parse(localStorage.getItem(this.otiumOrder)))}otiumOrderIsEmpty(){return null===localStorage.getItem(this.otiumOrder)}showTotalPriceInCart(){this.arrOrderLine.length>0&&(this.initialbalance=this.getTotalPrice(),this.finalbalance=this.initialbalance)}getTotalPrice(){let t=0;return this.arrOrderLine.forEach(r=>{t+=r.price}),console.log("TOTAL PRICE -> ",t),t}goToOrderPlaced(){this.router.navigate(["/order-placed"])}saveOrder(){const t=this.databaseService.createNewRandomId(),r=`restaurants/${this.qrData.restaurant}/orders/${this.dataUser.id}/ordersUser-${this.restaurantData.id}`,e=this.createNewOrder(t,r);this.dataService.updateOrder(e),this.dataService.createNewOrder(r,Object.assign({},e),t).then(()=>{console.log("PEDIDO REALIZADO CON EXITO")}),this.saveRestaurantFromOrdersUsers(),localStorage.removeItem(this.otiumOrder)}createNewOrder(t,r){return console.log("ID ORDER -> ",{idOrder:t}),new c(t,this.qrData.table,this.restaurantData.id,this.restaurantData.name,this.restaurantData.img,this.dataUser.id,r,this.arrOrderLine,this.finalbalance,o.otium,this.tip)}saveRestaurantFromOrdersUsers(){const t={restaurant:{id:this.restaurantData.id,img:this.restaurantData.img,name:this.restaurantData.name},path:`/restaurants/${this.restaurantData.id}/orders/${this.dataUser.id}/ordersUser-${this.restaurantData.id}`};console.log("this.restaurantFromOrdersUsers -> ",this.restaurantFromOrdersUsers),void 0!==this.restaurantFromOrdersUsers&&this.restaurantFromOrdersUsers.array===[]?this.dataService.saveNewRestaurantInUserOrders("restaurantFromOrdersUsers",{array:[t]},this.dataUser.id):this.restaurantFromOrdersUsers.array.some(r=>r.restaurant.id===t.restaurant.id)||(this.restaurantFromOrdersUsers.array.push(t),this.dataService.saveNewRestaurantInUserOrders("restaurantFromOrdersUsers",this.restaurantFromOrdersUsers,this.dataUser.id))}}return t.\u0275fac=function(r){return new(r||t)(u.Y36(n.F0),u.Y36(p),u.Y36(m.D),u.Y36(g.k))},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-pago"]],decls:47,vars:10,consts:[[3,"imgHeader"],["fullscreen","",1,"ion-padding"],["color","success","expand","block","fill","solid","size","large","shape","round",1,"cartbutton"],["slot","start","name","cart-outline"],[1,"margin-top"],["color","primary"],[1,"ion-text-center"],["mode","md"],["value","visa"],["src","../../../assets/icon/visa.png",1,"visa"],["src","../../../assets/icon/mastercard.png",1,"mastercard"],["color","primary",1,"creditcardText"],["slot","start","value","visa"],["slot","start","value","paypal"],["slot","start","value","crypto"],["slot","start","value","otiums"],["color","warning"],[1,"info-Otium"],["color","primary",1,"tip","ion-text-center"],[1,"tip"],["shape","round",3,"click"],["placeholder","Give a tip?","type","number","name","inputTip",1,"ion-text-center",3,"ngModel","ngModelChange"],["shape","round","type","submit",3,"click"],["color","primary","shape","round","expand","block","fill","solid","size","large",1,"payButton",3,"click"]],template:function(t,r){1&t&&(u.TgZ(0,"ion-header"),u._UZ(1,"app-header",0),u.qZA(),u.TgZ(2,"ion-content",1),u.TgZ(3,"ion-button",2),u._UZ(4,"ion-icon",3),u._uU(5),u.ALo(6,"number"),u.qZA(),u.TgZ(7,"ion-card",4),u.TgZ(8,"ion-card-header"),u.TgZ(9,"ion-card-title",5),u.TgZ(10,"h1",6),u._uU(11,"PAYMENT METHODS"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(12,"ion-card-content"),u.TgZ(13,"ion-list",7),u.TgZ(14,"ion-radio-group",8),u.TgZ(15,"ion-item"),u._UZ(16,"img",9),u._UZ(17,"img",10),u.TgZ(18,"ion-label",11),u._uU(19," CREDIT CARDS"),u.qZA(),u._UZ(20,"ion-radio",12),u.qZA(),u.TgZ(21,"ion-item"),u.TgZ(22,"ion-label",5),u._uU(23,"PAYPAL"),u.qZA(),u._UZ(24,"ion-radio",13),u.qZA(),u.TgZ(25,"ion-item"),u.TgZ(26,"ion-label",5),u._uU(27,"BITCOIN"),u.qZA(),u._UZ(28,"ion-radio",14),u.qZA(),u.TgZ(29,"ion-item"),u.TgZ(30,"ion-label",5),u._uU(31,"OTIUM"),u.qZA(),u._UZ(32,"ion-radio",15),u.TgZ(33,"ion-text",16),u.TgZ(34,"h5",17),u._uU(35,"GET 3% BACK"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(36,"ion-title",18),u._uU(37,"TIP"),u.qZA(),u.TgZ(38,"div",19),u.TgZ(39,"ion-button",20),u.NdJ("click",function(){return r.percentage()}),u._uU(40," 10% "),u.qZA(),u.TgZ(41,"ion-input",21),u.NdJ("ngModelChange",function(t){return r.inputTip=t}),u.qZA(),u.TgZ(42,"ion-button",22),u.NdJ("click",function(){return r.sumTip()}),u._uU(43," Add "),u.qZA(),u.qZA(),u.TgZ(44,"ion-button",23),u.NdJ("click",function(){return r.goToOrderPlaced()})("click",function(){return r.saveOrder()}),u._uU(45),u.ALo(46,"number"),u.qZA(),u.qZA()),2&t&&(u.xp6(1),u.Q6J("imgHeader",r.restaurantData.img),u.xp6(4),u.hij("",u.xi3(6,4,r.initialbalance,"1.2-2")," \u20ac "),u.xp6(36),u.Q6J("ngModel",r.inputTip),u.xp6(4),u.hij(" PAY ",u.xi3(46,7,r.finalbalance,"1.2-2")," \u20ac\n"))},directives:[s.Gu,O.G,s.W2,s.YG,s.gu,s.PM,s.Zi,s.gZ,s.FN,s.q_,s.se,s.QI,s.Ie,s.Q$,s.B7,s.U5,s.yW,s.wd,s.pK,s.as,a.JJ,a.On],pipes:[i.JJ],styles:[".info-Otium[_ngcontent-%COMP%]{margin-right:60px}.visa[_ngcontent-%COMP%]{height:48px}.mastercard[_ngcontent-%COMP%]{margin-top:15px;height:48px}.creditcardText[_ngcontent-%COMP%]{margin-top:35px}ion-input[_ngcontent-%COMP%]{border:3px solid var(--ion-color-medium);width:150px!important;color:var(--ion-color-primary);--placeholder-color:var(--ion-color-tertiary)}.payButton[_ngcontent-%COMP%], .tip[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.margin-top[_ngcontent-%COMP%], .payButton[_ngcontent-%COMP%], .tip[_ngcontent-%COMP%]{margin-top:1.875rem}"]}),t})()}];let T=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[n.Bz.forChild(Z)],n.Bz]}),t})();var v=e(9258);let b=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[i.ez,a.u5,s.Pc,T,v.K]]}),t})()}}]);