(self.webpackChunkFB_App=self.webpackChunkFB_App||[]).push([[469],{469:(t,e,a)=>{"use strict";a.r(e),a.d(e,{QrPageModule:()=>p});var n=a(8583),r=a(665),s=a(2859),i=a(430),o=a(8720),u=a(7436),c=a(4474),l=a(3646);const g=[{path:"",component:(()=>{class t{constructor(t,e,a){this.barcodeScanner=t,this.dataService=e,this.router=a,this.tempImg="../../../assets/logos/logo_XL.png",this.collectionRestaurants="restaurants",this.subcollectionCategories="categories",this.subDocumentItems="items",this.subcollectionProducts="products",this.inputRestaurant="",this.inputTable="",this.disabledButton=!0}ngOnInit(){this.dataService.currentArrRestaurantMenuData.subscribe(t=>this.arrRestaurantMenuData=t),this.dataService.currentArrRestaurantMenuCategory.subscribe(t=>this.arrRestaurantMenuCategory=t)}scannQr(){let t;this.barcodeScanner.scan().then(e=>{console.log("Barcode data OTIUM",e.text),t=JSON.parse(e.text),console.log("OTIUM QrData restaurant y table->",t.restaurant,t.table),this.getDataAndForward(t.restaurant,t.table)}).catch(t=>{console.log("Error",t)})}restaurantFromInput(){this.getDataAndForward(this.inputRestaurant,this.inputTable)}getDataAndForward(t,e){void 0===this.restaurantData||t!==this.restaurantData.id?(this.restaurantCleanData(),this.getDataRestaurant(this.collectionRestaurants,t)):t===this.restaurantData.id&&this.router.navigate(["/select"])}getDataRestaurant(t,e){this.dataService.getRestaurantData(t,e).then(t=>this.restaurantDataSubscription=t.subscribe(t=>{console.log("Datos del restaurante -> ",t),this.restaurantData=t,this.dataService.updateRestaurantData(this.restaurantData),this.restaurantDataSubscription.unsubscribe(),this.restaurantData?(this.getRestaurantCategories(this.collectionRestaurants,e,this.subcollectionCategories,this.subDocumentItems),this.getRestaurantMenu(this.collectionRestaurants,e,this.subcollectionProducts,this.subDocumentItems),this.router.navigate(["/select"])):this.dataService.showErrorRestaurantNotExist()}))}getRestaurantCategories(t,e,a,n){this.dataService.getRestaurantCategories(`${t}/${e}/${a}`,n).then(t=>this.restaurantMenuCategoriesSubscription=t.subscribe(t=>{console.log("DATOS DESDE FIRESTORE categories -> ",t);for(const e in t)null!==t&&this.arrRestaurantMenuCategory.push(t[e]);console.log("DATOS DESDE FIRESTORE arrRestaruantMenuCategory->",this.arrRestaurantMenuCategory),this.dataService.updateArrRestaurantMenuCategory(this.arrRestaurantMenuCategory),this.restaurantMenuCategoriesSubscription.unsubscribe()}))}getRestaurantMenu(t,e,a,n){this.dataService.getRestaurantMenu(`${t}/${e}/${a}`,n).then(t=>this.restaurantMenuDataSubscription=t.subscribe(t=>{console.log("DATOS DESDE FIRESTORE products->",t);for(const e in t)null!==t&&void 0!==t[e].idProduct&&this.arrRestaurantMenuData.push(t[e]);console.log("DATOS DESDE FIRESTORE arrRestaruantMenuData->",this.arrRestaurantMenuData),this.dataService.sortArray(this.arrRestaurantMenuData),this.dataService.updateArrRestaurantMenuData(this.arrRestaurantMenuData),this.restaurantMenuDataSubscription.unsubscribe()}))}verifyInputsToEnableButton(){setTimeout(()=>{this.disabledButton=3!==this.inputTable.length||3!==this.inputRestaurant.length},100)}restaurantCleanData(){this.restaurantData=void 0,this.arrRestaurantMenuCategory=[],this.arrRestaurantMenuData=[]}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(u.m),o.Y36(c.D),o.Y36(i.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-qr"]],decls:28,vars:4,consts:[[3,"imgUser"],[1,"div-content"],[1,"input-content"],["fixed",""],["size","12"],["mode","ios",3,"click"],[1,"ion-text-center"],["color","primary",1,"ion-align-self-center"],[1,"center-img"],["src","../../../assets/img/scan-qr-removebg.png","alt","mapa de google"],["size","12",1,"ion-text-center","margin-top"],["size","6"],["type","text","placeholder","Write restaurant",1,"corners",3,"ngModel","ionInput","ngModelChange"],["type","text","placeholder","Write table",1,"corners",3,"ngModel","ionInput","ngModelChange"],["expand","block","shape","round",1,"corners","margin-top",3,"disabled","click"]],template:function(t,e){1&t&&(o._UZ(0,"app-header",0),o.TgZ(1,"ion-content"),o.TgZ(2,"div",1),o.TgZ(3,"div",2),o.TgZ(4,"ion-grid",3),o.TgZ(5,"ion-row"),o.TgZ(6,"ion-col",4),o.TgZ(7,"ion-card",5),o.NdJ("click",function(){return e.scannQr()}),o.TgZ(8,"ion-card-content"),o.TgZ(9,"div",6),o.TgZ(10,"ion-text",7),o.TgZ(11,"h1"),o._uU(12,"Touch and scan the table"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(13,"div",8),o._UZ(14,"img",9),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(15,"ion-row"),o.TgZ(16,"ion-col",10),o.TgZ(17,"ion-text"),o._uU(18,"Problems with the scan?"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(19,"ion-row"),o.TgZ(20,"ion-col",11),o.TgZ(21,"ion-input",12),o.NdJ("ionInput",function(){return e.verifyInputsToEnableButton()})("ngModelChange",function(t){return e.inputRestaurant=t}),o.qZA(),o.qZA(),o.TgZ(22,"ion-col",11),o.TgZ(23,"ion-input",13),o.NdJ("ionInput",function(){return e.verifyInputsToEnableButton()})("ngModelChange",function(t){return e.inputTable=t}),o.qZA(),o.qZA(),o.qZA(),o.TgZ(24,"ion-row"),o.TgZ(25,"ion-col",4),o.TgZ(26,"ion-button",14),o.NdJ("click",function(){return e.restaurantFromInput()}),o._uU(27," Send "),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.Q6J("imgUser",e.tempImg),o.xp6(21),o.Q6J("ngModel",e.inputRestaurant),o.xp6(2),o.Q6J("ngModel",e.inputTable),o.xp6(3),o.Q6J("disabled",e.disabledButton))},directives:[l.G,s.W2,s.jY,s.Nd,s.wI,s.PM,s.FN,s.yW,s.pK,s.j9,r.JJ,r.On,s.YG],styles:[".div-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;height:90vh;padding-left:1.875rem;padding-right:1.875rem}.corners[_ngcontent-%COMP%]{border-radius:25px;border:2px solid var(--ion-color-tertiary);text-align:center;--placeholder-font-weight:12px!important}.input-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}ion-card[_ngcontent-%COMP%]{border:1px solid #3c0080;box-shadow:3px 3px 8px #3c0080;border-radius:2.5rem}.center-img[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-bottom:1.25rem}.margin-top[_ngcontent-%COMP%]{margin-top:20px}"]}),t})()}];let d=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[i.Bz.forChild(g)],i.Bz]}),t})();var h=a(5642);let p=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[n.ez,r.u5,s.Pc,d,h.K]]}),t})()}}]);